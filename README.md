# Easy Prompt Selector

基于[原插件](https://github.com/blue-pen5805/sdweb-easy-prompt-selector):

- 修改了相关**按钮**为**中英文**
- 优化了代码
  - 支持**标签文件**基于**子文件夹**进行分类和管理
  - 强化了**标签随机选择**功能,使其更加智能
- 增加了**中文**提示词**标签库** (来源于[路过银河](https://zhuanlan.zhihu.com/p/637757484)大大制作的词包!!)

## 基本使用

- 在默认状态下,**默认标签文件夹**(`./tags/`)为**空**,插件将自动拷贝**示例标签文件夹**(`./tags_examples/`)中的**所有**示例标签进行使用!
  - 注意!! 拷贝会包括`🔞十八禁`标签~~~
  - 推荐: 根据需要,将需要的标签文件**拷贝**到**默认标签文件夹**中,以规避使用**整个示例标签文件夹**.
- **标签文件的文件名**即为显示在WebUI上下拉列表中的**选项名** - 你可以参考**示例标签文件夹**中的文件名,利用`_`来进行分类和排序.
  - 注意!! 标签文件的文件名确保**全局唯一**!! 否则相同文件名会产生覆盖.
  - 标签文件可以通过**子文件夹**方便分类管理.
    - 注意!! 子文件夹的文件夹名不会出现在**选项名**中.
- 标签文件的定义格式为`yaml`格式. 其中,
  - 每个标签项中,`:`**前面**的是显示在WebUI上的**选项名**, **后面**的是插入到**提示词输入框**中的**提示词**.
  - 注意!!在**每一个层级**中, **选项名**不能重复!! 例如, 下面的写法是错误的.
  - 如果**提示词**有**数字, 或其他特殊符号(例如: `{}, <>` 等)**, 需要用**引号**(`""`)进行包裹
- 选择标签分为 **2** 个级别:
  - 标签类别 - 鼠标**左键**点击后添加一个**标签随机选择标记**, 在生成图片时根据规则随机替换为一个**该类别中**的一个标签.
  - 标签 - 鼠标**左键**点击添加, **右键**点击去除.

```yaml
# tags/建筑.yml
建筑:
  房子: house
  # 注意!! `选项名`不能重复!
  房子: home
```

> 注意!! 由于插件会对`@, $`进行语义转换处理, 因此, 在使用本插件的时候, 尽量避免在提示词中使用`@, $`.

## 高阶使用 - 标签随机选择标记

最新版的插件支持通过`@, $`的语义解析, 定义一个**标签随机选择标记**, 可以实现:

- 通过定义,可以在**一定的范围内**随机选择**一定数量**的标签
- 上述选择过程可以**嵌套**
  - 注意: 考虑到性能, **嵌套**最大可以到 `10` 层
- 格式: `@{num|min-max}$${tag_path}@`
  - `{num|min-max}$$` - 标明**随机选择**的个数, 可选
    - 没有的话,默认**随机选择 1 个**
    - `num` 和 `min-max` 只需要使用一个; 使用 `min-max` 时, `min`为最小值(可以为`0`),`max`为最大值
  - `tag_path` 标明目标标签的**获取路径**, 从`最初的标签文件名`开始
    - 多级路径以 `:` 进行分隔

### 使用举例

```yml
# 文件名: color.yml
Color:
  Black: black
  White: white
  Yellow: yellow
  Blue: blue

# 文件名: hair.yml
Random hair color:
  # 随机 1 个头发颜色
  Random: '@color:Color@ hair'
  # 随机 2 个头发颜色
  Random_2: '@2$$hair:Random hair color:Random@'

# 文件名: animal.yml
Animal:
  Cat: cat
  Dog: dog
  Panda: panda
  Gorilla: gorilla

Random Animal:
  # 随机 0-2 个动物
  Random: '@0-2$$animal:Animal@'
  # 随机 1 个动物
  Random_1: '@animal:Animal@'
  # 随机 3 个动物
  Random_3: '@3$$animal:Animal@'
  # 随机 1 个动物, 随机动物头发颜色
  Random_Hair: '@animal:Animal@, @hair:Random hair color@'
```
